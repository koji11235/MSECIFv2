# Multi-shelled-ECIF
Improved version of extended connectivity interaction features (ECIF) by enabling to take the atomic distance into account.

<img src="./graphical_abstract.png" alt="">

## Script
* msecif.py
   * Codes used to extract multi-shelled ECIF and weighted ECIF features; place in the same directory as PDB_Atom_Keys.csv. 
Ex1_generate_feature.ipynb relies on this.

## Examples
1. Ex1_generate_feature.ipynb
   * Feature generation example of multi-shelled ECIF and weighted ECIF. This notebook generates Ex1_multi-shelledECIF_feature.csv and Ex1_weightedECIF_feature.csv.
3. Ex2_train_model.ipynb
   * Model training example of multi-shelled ECIF and weighted ECIF.

## Results
* multi-shelledECIF_all_results.csv
   * Evaluation results of multi-shelled ECIF of all conditions (threshold and step) and all seed values. The evaluation was performed with pearson correlation coefficient （PCC) and root mean squared error (RMSE) of the CASF2016 core set.
* weightedECIF_all_results.csv
   * Evaluation results of weighted ECIF of all conditions (threshold) and all seed values. The evaluation was performed with PCC and RMSE of the CASF2016 core set.
* FeatureImportance/feature_importance_thresh10.0_step1.0.csv
   * All the feature importance of the best multi-shelled ECIF model.

## Features
* Multi-shelledECIF_threshold*_step*.csv.zip
   * Multi-shelled ECIF features of each condition.　Please unzip before use. Only Multi-shelledECIF_threshold12.0_step0.5.csv.zip is not here for file size reasons.
* WeightedECIF_*.csv.zip
   * Weighted ECIF features of each condition.　Please unzip before use.
* RDkit_Discriptors.csv
   * Ligand descriptors generated by RDkit.
* BindingData.csv
   * Correct labels. The PDBID, pK value, and whether it is a Train set or Test set are listed.


## SampleStructures
Sample structures of 5 complexes.  
Each folders includes {PDBID}_ligand.mol, {PDBID}_ligand.sdf, {PDBID}_ligand_H_added.sdf, {PDBID}_pocket.pdb and {PDBID}_protein.pdb.   
When you generate features, please use {PDBID}_ligand_H_added.sdf for ligand file and {PDBID}_protein.pdb for protein file.






